---
title: "Benefits and limitations of increasing the stock-selectivity of Pacific salmon fisheries"
author: |
  First. M. Last^1^ and
  Alex B. Smith^2^
author_list: "Last, F.M. and Smith, A.B."
address: |
  ^1^Pacific Biological Station\
     Fisheries and Oceans Canada, 3190 Hammond Bay Road\
     Nanaimo, British Columbia, V9T 6N7, Canada\
  ^2^Far, far away\
     Another Galaxy
month: Month # fill in
year: 2019
report_number: nnn
region: Pacific Region
citation_other_language: "Last, F.M. et Smith, A.B. Title Here (*Latin Species Name*). DFO Secr. can. de consult. sci. du MPO. Doc. de rech 2019/nnn. iv + 13 p."
abstract: |
 Population diversity can stabilize the dynamics of ecological systems and increase their resilience to future environmental change. In exploited systems, however, management goals to preserve diversity may be in tension with harvest objectives. For example, fisheries managers may forgo opportunities to sustainably harvest abundant populations to reduce risks to less productive populations. Increasing the stock selectivity of fisheries is one management lever that may allow for both conservation- and catch-based objectives to be met. We develop a model simulating the ecological dynamics of salmon stock aggregate and its fishery to evaluate how changing allocations between mixed- and single-stock fisheries influences management performance. We focus on relatively generic management strategies that may be implemented in a range of salmon fisheries. Additionally we examine how the relative performance of mixed- and single-stock fisheries change under alternative ecological and management scenarios. We find that increasing single-stock fishery allocations can increase aggregate abundance and the status of stocks relative to conservation benchmarks. However these trade-offs do not occur uniformly across stocks -- relatively abundant, productive populations exhibit no change or even declines in conservation performance as single-stock fishery allocations increase. Furthermore, differences in performance between mixed- and single-stock fisheries are reduced when productivity is uniformly low, mortality during freshwater migrations is high, or when the mixed-stock fishery is managed conservatively. While single-stock fisheries can increase the probability that conservation-based objectives will be met, they are not a panacea and may only be effective when specific conditions are met.
header: "Draft working paper --- Do not cite or circulate" # or "" to omit
output:
 # csasdown::resdoc_pdf:
 #   french: false
  csasdown::resdoc_word
# ------------
# End of options to set
knit: bookdown::render_book
link-citations: true
bibliography: bib/ms_singleStock.bib
csl: csl/ecology.csl # or csl/csas-french.csl for French
# Any extra LaTeX code for the header:
# header-includes:
# - \usepackage{tikz}
---

```{r setup, echo=FALSE, cache=FALSE, message=FALSE, results='hide', warning=FALSE}
# adjust as desired:
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  comment = "#>",
  fig.path = if (knitr:::is_latex_output()) "knitr-figs-pdf/" else "knitr-figs-docx/",
  cache.path = if (knitr:::is_latex_output()) "knitr-cache-tex/" else "knitr-cache-docx/",
  fig.asp = 0.618,
  fig.width = 9,
  out.width = "6in",
  echo = FALSE,
#  autodep = TRUE,
#  cache = TRUE,
  cache.comments = FALSE,
  dev = if (knitr:::is_latex_output()) "png" else "png",
  dpi = 180,
  fig.align = "center",
  fig.pos = "htb"
)
options(kableExtra.latex.load_packages = FALSE)
```

```{r load-libraries, cache=FALSE}
# add other packages here:
library(csasdown)
library(here)
library(tidyverse)
library(samSim)
library(knitr)
library(kableExtra)
```

<!--chapter:end:index.Rmd-->

# INTRODUCTION

Resource management is characterized by trade-offs between conservation- and harvest-based objectives. Fisheries managers, for example, are tasked with ensuring that populations remain sufficiently abundant to minimize exitinction risk and sustain intact ecosystems. While conservation objectives are often legally prioritized, managers are simultaneously under pressure to meet harvest objectives related to food security, cultural traditions, or economic development. To reconcile these tensions, fisheries scientists have attempted to design harvest strategies that maximize yield and minimize the risk of overexploitation. For example, management strategy evaluations can be used to develop harvest control rules in a collaborative manner, while accounting for pervasive uncertainty [@Punt2016].

Many fisheries are multi-stock, composed of reproductively isolated populations, which may exhibit differences in productivity, capacity, and sustainable exploitation rates [@Ricker1958; @Hilborn1985]. The simplest management approach, and historically the most frequently employed, is to identify target harvest rates based on the dynamics of stock aggregates defined by management boundaries rather than underlying population structure [@Stephenson2002a]. If the dynamics of stocks within the fishery are relatively similar, or exploitation is sufficiently low, such a strategy may be effective. When these assumptions are not met, however, harvest rates that are sustainable at the aggregate scale may deplete less productive stocks and result in extirpation [@Ricker1958; @Reiss2009]. 

Reductions in stock diversity can negatively impact conservation and harvest objectives by increasing spatial and temporal variability of catches as ecological portfolio effects weaken [@Hilborn2003; @Schindler2010; @FreshwaterSub]. Given uncertainty about future environmental conditions, maximizing stock diversity is a critical means of increasing long-term resilience [@Anderson2015; @Link2018]. To that end, minimizing harvest rates of depleted populations in mixed-stock fisheries may be necessary to reduce overexploitation risks. One strategy is to implement highly precautionary management targets for ecological aggregates that are based on the dynamics of the least productive component stock(s). While such a strategy will reduce the probability of overfishing across all stocks, it is likely to increase tension between conservation and socio-economic objectives as yield is lost from more productive stocks. In cases where declines in fleet size or landings have already strained fishing communities, further reductions may receive substantial political opposition.

One method of reconciling conservation and socio-economic objectives is to shift harvest effort towards single-stock fisheries, which allow managers to reduce the risk of overexploitation of less productive stocks while capitalizing on surplus production of productive stocks. Increasing the stock selectivity (i.e. the ability to target some stocks over others) is particularly relevant to Pacific salmon (*Oncorhynchus* spp.) where stocks are highly structured, but the majority of harvest currently occurs in mixed-stock marine fisheries. Many salmon management aggregates are composed of both abundant and depleted stocks, and in extreme cases include stocks that sustain large commercial fisheries, as well as stocks of critical conservation concern. For example within the Fraser River sockeye salmon (*O. nerka*) aggregate, the abundant Chilko and endangered Quesnel stocks are harvested in the same mixed-stock fishery [@COSEWIC2017]. 

Extensive efforts have often been made to fine-tune large, commercially important salmon fisheries to maximize their stock selectivity. Variation among stocks in migratory routes or timing are incorporated into run reconstructions, which generate stock-specific harvest rates and, ultimately, time series of spawner and recruit abundance [@Cunningham2018]. Given sufficient spatial or temporal segregation among stocks, managers can utilize these data to reduce fishing mortality on depleted stocks [@Walters2008; @Cunningham2019]. When the overlap among stocks is too great for closures to be effective, stock selectivity may also be increased by moving harvest towards spawning grounds and developing terminal fisheries [@Walters2008]. 

As knowledge of population structure improves, it will be possible to more broadly utilize management levers that adjust the proportion of a fishery that is mixed- or single-stock. While the challenges associated with mixed-stock salmon fisheries have been widely documented [@Ricker1973; @Hilborn1985; @Walters2019], the tradeoffs between conservation and socio-economic goals associated with single-stock fisheries have not been explicitly quantified. Furthermore, it is unclear how such tradeoffs may be impacted by non-stationary population dynamics and other ecological processes. En route mortality, the proportion of adult recruits dying during freshwater migrations, may have particularly severe impacts on the viability of single-stock fisheries. En route mortality rates can exceed 90% in certain years [@Cooke2004], are likely to occur more frequently with climate change [@Martins2012], and will disprortionately impact terminal fisheries. 

Here we use a stochastic closed-loop simulation model to evaluate how shifting Pacific salmon harvest from mixed- to single-stock fisheries impacts a suite of performance metrics. We first develop abundance-based harvest control rules for mixed- and single-stock fisheries that could be implemented using commonly available data. We then evaluate how changes in allocation moderate conservation- and catch-based performance. Finally, we quantify how trade-offs associated with shifting from mixed- to single-stock fisheries may be moderated by population productivity and en route mortality. We note that the impacts of changes in allocation will vary among user groups, dramatically complicating any management process; however it was beyond the scope of the current study to fully account for socio-economic trade-offs related to access.

<!--chapter:end:01-intro.Rmd-->

```{r loadPackagesAndData, include=FALSE}
simPar <- read.csv(here::here("data", "manProcScenarios",
                        "fraserMPInputs_varyAllocationVaryMixHCR.csv"),
                   stringsAsFactors = F)
cuPar <- read.csv(here::here("data/summOnlyCUPars.csv"), stringsAsFactors = F)
srDat <- read.csv(here::here("data/fraserRecDatTrim.csv"), stringsAsFactors = F)
catchDat <- read.csv(here::here("data/fraserCatchDatTrim.csv"), 
                     stringsAsFactors = F)
```

# METHODS 

## 2.1 Sockeye salmon biology and fisheries

The closed-loop simulation model is structured to reflect the life history of sockeye salmon and is parameterized using data from stocks within the Fraser River. Sockeye salmon is an anadromous, semelparous fish distributed throughout the northern Pacific. Populations in southern British Columbia typically rear as juveniles in freshwater lakes for one-two years, mature in the Gulf of Alaska, and return to spawn as two- to five-year olds [@Burgner1991]. Under Canada’s Wild Salmon Policy (WSP), Pacific salmon status is assessed at the scale of conservation units (CUs), genetically isolated groups of spawning populations [@DFO2005]. While CUs are not precisely equivalent to stocks, we use the latter term throughout to place our analysis in a more generic context.

The Fraser River aggregate is Canada’s largest sockeye salmon run, but is increasingly vulnerable to anthropogenic development, overexploitation, and climate change [@COSEWIC2017]. Productivity throughout the system declined in the 1990s [@Peterman2012; @Freshwater2018], resulting in frequent fishery closures and an emergency federal inquiry into the causes of the declines [@Cohen2012]. While some stocks have shown signs of recovery in recent years, most remain at very low productivity levels, with ten of 24 assessed as at risk of extinction [@COSEWIC2017]. 

Although Fraser River sockeye salmon status is assessed at the stock level, the harvest is managed using four run timing aggregates (management units; MUs). As a result, harvest effort can be constrained at the scale of MUs, but not individual stocks. Since MUs can include stocks ranging in status from abundant to severely depleted, increasing the stock-selectivity of harvest rates may provide an opportunity to increase the probability of rebuilding depleted stocks, while minimizing socio-economic impacts.  

```{r calcTS, include=FALSE}
stks <- unique(cuPar$stk)
d <- srDat %>% 
  filter(stk %in% stks,
         !is.na(rec2)) %>% 
  select(stk, yr) %>% 
  group_by(stk) %>% 
  summarise(min = min(yr), 
            max = max(yr))
maxY <- min(d$max)
minY <- max(d$min)
diff <- maxY - minY
```

We focused our analysis on the summer-run MU, which contains six stocks that vary in status and cyclic behavior. The stock-recruit time series cover `r diff` years, begining in `r minY` and ending in `r maxY`. Note that throughout this manuscript we use the term *return* abundance to refer to the sum of catch and escapement in a given return year, where escapement is defined as the number of fish that have escaped all fisheries. In comparison, we use the term *recruit* abundance to refer to the sum of catch and escapement produced by spawners from a given brood year (see @Grant2011 for details).

## 2.2 Forward simulation

Closed-loop simulations provide a powerful tool to evaluate the trade-offs among objectives associated with different management frameworks and the consequences of uncertainty [@Punt2016]. Typically closed-loop simulations contain two main components. First, the operating model represents the system attributes that are largely beyond the control of managers (e.g. population dynamics of stocks). The second component, the management procedure, represents dimensions of the fishery under anthropogenic control. Examining the performance of different management procedures can be used to evaluate the impact of different harvest control rules [@Cooke1999; @Holt2008; @Collie2012], while different operating models can be used to evaluate the impact of dynamic processes, such as changes in natural mortality and recruitment deviations [@Holt2010; @Forrest2018; @Freshwater2019].

### 2.2.1 Reference operating model

The structure of the operating model is equivalent to that in Freshwater et al. (2019) and is described in detail in Appendix S1. Briefly the dynamics of each stock were simulated using an age-structured, Ricker spawner-recruit model [@Ricker1975]

Equation 2  $$log_e(\frac{R_{i,y}}{S_{i,y}}) = \alpha_i - \beta_iS_{i,y} + w_{i,y}$$

where $i$ represents a stock, $y$ is a given brood year, $R$ the number of recruits, and $S$ the number of spawners. The parameter $\alpha$ represents the number of recruits produced per spawner at low abundance, while $\beta$ is the density-dependent parameter (i.e. the reciprocal of the number of spawners that maximizes recruitment). Recruitment deviations $w_{i,y}$ are normally distributed with mean 0 and variance $\sigma^2$.

A subset of Fraser River stocks are cyclic, exhibiting large differences in abundance at four-year intervals. We used a Larkin model, an extension of the Ricker model that accounts for delayed-density dependent effects [@Larkin1971], to simulate the dynamics of cyclic stocks (two of six stocks in the Summer Run MU; Appendix S1).

To account for productivity declines in Fraser River sockeye salmon [@Peterman2012; @Freshwater2018], we used a recursive Bayes stock-recruitment model to estimate non-stationary $\alpha$ parameters from the historical time series. We parameterized the forward simulation model with median parameter sets (i.e. median $\alpha$ from the most recent time step and corresponding $\beta$ and $\sigma$) estimated from stock-specific models (Appendix S1).

The simulation model included multiple sources of mortality in addition to the natural mortality implicitly incorporated in the spawner-recruit relationship. First, we simulated harvest $C$ in mixed- and single-stock fisheries (details in *2.2.2 Management Procedure*). We also simulated stock-specific en route mortality $D$, which accounts for natural mortality during upstream migration, unreported harvest, post-release fishing mortality, and error between in-river and terminal estimates of spawner abundance [@Grant2011]. In the reference case en route mortality occurred after both mixed- and single-stock fisheries (but see *2.2.3 Alternative Operating Models*). We modeled en route mortality as a stochastic process that varied by stock as a function of escapement

Equation 3 $$ D_{i,t} \sim \text{lognormal}(d_{i}(R'_{i,t} - C_{i,t}), \sigma^2_{mort,i}) $$

where $d$ represents the mean and $\sigma_{mort}$ the standard deviation of the en route mortality rate for stock $i$ (details in Appendix S1). 

Spawner abundance $S$ was then calculated as 

Equation 4 $$ S_{i,t} = R'_{i,t} - C_{i,t} - D_{i,t}.$$

Additional operating model components, including temporal autorcorrelation and among-stock covariance in simulated recruitment deviations $w_{i,y}$, as well as interannual variation in age-at-maturity, are described in Appendix S1.

### 2.2.2 Management procedure

The management procedure contained a harvest component, representing the dynamics of two distinct fisheries, as well as an observation and assessment component that simulated data collection and assessed status relative to management targets.

We modeled tradeoffs between mixed- and single-stock fisheries by calculating target catch for each stock and allocating a fixed proportion of that target catch to each fishery. Although the stock-selectivity of a fishery can be increased using various spatial or temporal restrictions, we modeled fully segregated and sequential fisheries. This structure maximized contrast between different allocations and is plausible for salmon where fisheries in terminal areas have been developed for several stocks [@DFO2017a].

We modeled catch in each fishery in three distinct steps. First, an MU-level target exploitation rate $u_{targ}$ was calculated based on aggregate abundance, using a generic harvest control rule proposed under Fisheries and Oceans Canada's Precautionary Approach Framework [@DFO2009]. $u_{targ}$ ranged between 10% (a minimum exploitation rate approximating incidental harvest) and the exploitation rate at maximum sustainable yield, ${u}_{MSY}$, as a function of aggregate return abundance relative to two fishery reference points. The reference points are spawner abundances (40% and 80%) relative to the spawner abundance estimated to lead to maximum sustainable yield (Appendix S1).

Second, we calculated stock-specific target catch for each fishery ($C_{targ,mix,i}$ and $C_{targ,sing,i}$) as

Equation 7a $$ C_{targ,mix,i,t} = pu_{targ}R'_{i,t} $$
Equation 7b $$ C_{targ,sing,i} = (1-p)u_{targ}R'_{i,t} $$

where $u_{targ}$ is the target exploitation rate, $R'$ is return abundance, and $p$ is the proportion of the total catch allocated to the mixed-stock fishery. We varied $p$ from 0 to 1, in increments of 0.25, to evaluate the impact of changing the relative proportion of catch harvested in mixed- vs. single-stock fisheries. Note that $C_{targ}$ calculations assume that stock-specific return abundance is known without error, which may result in overestimates of single-stock fishery performance (see Appendix S1).

Third, we reduced the impacts of fisheries on depleted populations by closing single-stock fisheries when median observed spawner abundance, $\tilde{S}_{med}$, was below a biological benchmark consistent with conservation concern, $S_{con}$. In the case of non-cyclic stocks (modeled with a Ricker relationship) the single-stock harvest control rule was

Equation 8a $$ C_{targ,sing,i,t} = 0 \text{ if  } \tilde{S}_{med,i} < S_{con,i} $$
Equation 8b $$ \tilde{S}_{i,t} \sim \text{lognormal}(S_{i,t}, \sigma^2_{obs}). $$ 

In the case of cyclic stocks (modeled with a Larkin relationship) the single-stock fishery was closed (i.e. $C_{targ,sing,i,t} = 0$) unless the current simulation year was a dominant cycle line (defined by calendar year) and the previous dominant return year's spawner abundance was greater than ${S}_{gen,i}$ [@DFO2018a]. Observed spawner abundance, $\tilde{S}_{i,t}$, will differ from true spawner abundance due to estimation processes. We defined $S_{con}$ in the context of Canada's Wild Salmon Policy, setting $S_{con,i}$ to the abundance that will result in spawner abundance leading to ${S}_{MSY}$ in one generation in the absence of fishing mortality, ${S}_{gen,i}$ [@DFO2005; @Holt2009]. 

Realized catches in each fishery included outcome uncertainty, which represents deviations between target and realized catches [@Holt2006]. We simulated realized exploitation rates $u$ as random variables sampled from a beta distribution:

Equation 9a $$ u_{i,t} \sim \text{beta}(a_{i,t}, b_{i,t})$$

where the shape parameters $a$ and $b$ were calculated from target exploitation rates $u_{targ}$ and empirically-based estimates of among-year variation in deviations between target and realized exploitation rates, $\sigma_{out}$, as follows:

Equation 9b $$ a_{i,t} = u_{targ,i,t}^2 ({\frac{1 - u_{targ,i,t}} {\sigma_{out}^2}} - {\frac{1}{u_{targ,i,t}}}) $$
Equation 9c $$ b_{i,t} = a_{i,t}({\frac{1} {u_{targ,i,t}}} - 1).$$

Details on the parameterization of $\sigma_{out}$ are described in Appendix S1.

We note that Fraser River sockeye salmon are currently managed with a more conservative harvest control rule (total allowable mortality (TAM) rule), which attempts to account for cyclic abundance, overlapping run timings among MUs, en route mortality, and other system-specific management adjustments [@Pestal2011]. However the reference points associated with the TAM rule vary interannually and are informed by expert opinion, reducing its relevance to salmon fisheries in general. The TAM rule is summarized in Appendix S1 and we present the results of a secondary analysis comparing its performance to the generic HCR.

### 2.2.3 Alternative operating models

We evaluated the relative performance of different fishery allocations across two sets of alternative operating models. First, we incorporated different productivity regimes by applying a scalar (0.6 to 1.1 in increments of 0.05) to each stock's estimate of $\alpha$. The bounds of the scalar were chosen based on observed changes in productivity (mean ~30% decline during the time series, ranging from 54% decline to 53% increase). The scalar simulated hypothetical, additional future changes that might mirror those that have already occurred.

Second, we modeled the impact of single-stock harvest that occurred after en route mortality

Equation 10 $$ C_{sing,i,t} = (R'_{i,t} - C_{mix,i,t} - D_{i,t})u_{sing,i,t}. $$

Thus spawner abundance was calculated as

Equation 11 $$ S_{i,t} = R'_{i,t} - C_{mix,i,t} - D_{i,t} - C_{sing,i,t}. $$

This modification is intended to represent a scenario where single-stock fisheries can only be developed in fully terminal areas. Such a scenario may be particularly relevant to highly mixed-stock fisheries such as Fraser River, Bristol Bay, and Skeena River sockeye salmon because the large number of stocks and the overlap in migration timing among stocks [@Grant2011; @Walters2008; @Cunningham2019], will constrain the selectivity of fisheries that are not fully terminal. Since en route mortality in the Fraser River can be considerable in certain years [@Grant2011; @Cooke2004], the abundance of fish available to harvest will be lower in terminal fisheries in those years relative to marine, altering trade-offs between conservation and catch objectives. 

Additionally, we completed sensitivity analyses to evaluate the impact of our assumptions about the magnitude of: temporal autocorrelation in recruitment deviations ($\tau$), error associated with estimating spawner abundance ($\sigma_{obs}$), outcome uncertainty ($\sigma_{out}$), and interannual variability in age-at-maturity ($\gamma$) and en route mortality ($\sigma_{mort}$) (Appendix S2).

### 2.2.4 Performance metrics

We considered a range of conservation- and catch-based performance metrics to determine how fishery allocations impact management performance (Table \@ref(tab:pmTable)). We evaluated both stock-specific and aggregate (i.e. summed or mean values within the MU) performance metrics. We present median outputs among simulations for each performance metric, as well as the 5th and 95th percentiles.

```{r pmTable, results="asis"}
pmTable <- read.csv(here::here("data", "msTables", "pmTable.csv"))

k <- knitr::kable(pmTable, format = "pandoc", booktabs = TRUE, linesep = "",
                  caption = "Aggregate and stock-specific performance metrics.",
                  "latex") 
k <- kableExtra::kable_styling(k, font_size = 12)
k
```

We initialized the simulation with stock-specific time series of spawner and recruit abundance and ran the simulation for $`r simPar[["simYears"]][1]`$ years (approximately $`r round(simPar[["simYears"]][1]/4, 0)`$ generations). We summarized performance metrics across 1500 Monte Carlo trials (convergence occurred after approximately 1200). 

<!--chapter:end:02-methods.Rmd-->

## Results 

```{r loadSimRunData, include=FALSE}
library(samSim)
library(ggpubr)
library(tidyverse)
## Simulation ran in varyAllocation_mainSimRun.R, which also includes example figures
simPar <- read.csv(here::here("data", "manProcScenarios",
                        "fraserMPInputs_varyAllocationVaryMixHCR.csv"),
                   stringsAsFactors = F)
simParTrim <- simPar %>%
  filter(nameOM %in% c("ref", "enRoute"),
         benchmark == "stockRecruit")
scenNames <- unique(simParTrim$scenario)
dirNames <- sapply(scenNames, function(x) paste(x, unique(simParTrim$species), 
                                                sep = "_"))

#ID stocks included in CU-specific analyses
cuPar <- read.csv(here::here("data/fraserCUPars.csv"), stringsAsFactors = F)
summCUs <- cuPar %>% 
  filter(manUnit == "Summ") %>% 
  mutate(abbStkName = abbreviate(stkName, minlength = 4)) %>% 
  select(abbStkName) %>% 
  unlist()

agVarsToPlot <-  c("medRecRY", "medSpawners", "ppnCULower", 
                   "medCatch", "stabilityCatch", "medER")

agDat <- buildDataAgg(dirNames, agVars =  agVarsToPlot, 
                      keyVarName = "ppnMixed") %>%
  mutate(mp = case_when(
    str_detect(mp, "genPA") ~ "Generic",
    str_detect(mp, "TAM") ~ "TAM"
  ), 
  labelledVar = var) %>%
  mutate(mp = as.factor(mp), 
         labelledVar = fct_recode(labelledVar, 
                                  "Aggregate\nReturn Abundance" = "medRecRY",
                                  "Aggregate\nSpawner Abundance" = 
                                    "medSpawners",
                                  "Proportion of CUs\nAbove Cons. BM" = 
                                    "ppnCULower",
                                  "Aggregate\nCatch" = "medCatch",
                                  "Catch\nStability" = "stabilityCatch",
                                  "Median\nExploitation Rate" = "medER")) 

refDat <- agDat %>% 
  filter(om == "ref", 
         mp == "Generic") 
```

Large allocations to mixed-, rather than single-stock fisheries, resulted in reductions in aggregate conservation-based performance metrics, including median return abundance, median spawner abundance, and the mean proportion of stocks above their conservation benchmark (Appendix S2). Conversely median aggregate catch and aggregate catch stability were maximized at intermediate allocations to mixed-stock fisheries (Appendix S2). These impacts on conservation- and catch-based metrics were driven by differences in realized exploitation rates, which increased with mixed-stock fishery allocations (Appendix S2).

```{r recDecline, include=FALSE}
f <- function(ppnM, V = "medRecRY") {
  refDat %>% 
    filter(var == V, ppnMixed == ppnM) %>% 
    select(avg) %>% 
    as.numeric()
}
recDecline <- round((f(ppnM = "0") - f(ppnM = "0.5")) / f(ppnM = "0"), 
                    digits = 2) * 100
ppnDecline <- round((f(ppnM = "0", V = "ppnCULower") - f(ppnM = "0.5", 
                                                         V = "ppnCULower")) / 
                      f(ppnM = "0", V = "ppnCULower"), 
                    digits = 2) * 100
```

At the aggregate scale, intermediate mixed-stock allocations optimized trade-offs between conservation- and catch-based objectives. For example, splitting total allowable catch evenly between mixed- and single-stock fisheries led to high median catches, while resulting in relatively modest declines in median return abundance (`r recDecline`% decline; Fig. \@ref(fig:aggTO)a) and the mean proportion of stocks above their conservation benchmark (`r ppnDecline`% decline; Fig. \@ref(fig:aggTO)b).

```{r aggTO, warnings=FALSE, messages=FALSE, fig.cap="Trade-offs between aggregate conservation- and catch-based performance metrics across a range of mixed-stock fishery allocations. Points represent medians and whiskers represent 90th percentile intervals among Monte Carlo trials."}
# Fig. 2 - Agg tradeoff plots
consVec <- c("medRecRY", "ppnCULower")
catchVec <- rep(c("medCatch"), times = length(consVec))
conLabels <- c("Median Aggregate\nReturn Abundance", 
               "Proportion of Stocks\nAbove Benchmark")
panelLabs <- data.frame(lab = c("a)", "b)"),
                        var = factor(consVec, 
                                     levels = unique(consVec)))
dum <- refDat %>% 
  filter(var == "medCatch")

toAgList <- lapply(seq_along(consVec), function(x) {
  p <- plotAgTradeoff(refDat %>% select(-labelledVar), consVar = consVec[x], 
                      catchVar = catchVec[x],
                      facet = NULL, shape = NULL, showUncertainty = TRUE,
                      xLab = "", yLab = conLabels[x], 
                      legendLab = "Proportion\nMixed-Stock\nTAC",
                      axisSize = 14, dotSize = 6, legendSize = 14,
                      lineSize = 1.5, scaleAxis = "fixed", hotColors = FALSE) +
    geom_text(data = panelLabs %>% filter(var == consVec[x]),
              mapping = aes(x = max(0.97 * dum$highQ), y = Inf, label = lab,
                            vjust = 1.5),
              show.legend = FALSE, inherit.aes = FALSE, size = 6)
  return(p)
})
panelTO <- ggarrange(toAgList[[1]], toAgList[[2]], ncol = 2, nrow = 1,
                             common.legend = TRUE, legend = "right")
annotate_figure(panelTO, bottom = ggpubr::text_grob("Median Aggregate Catch",
                                                   size = 15, vjust = -0.5))
```

Trade-offs were more nuanced at the scale of individual stocks. For example, abundant and relatively productive stocks either were insensitive (Harrison stock, Fig. \@ref(fig:cuTO)) or responded positively (Chilko CU, Fig. \@ref(fig:cuTO)) to increases in mixed-stock fishery allocations. In both cases, single-stock fisheries were rarely closed (because the stock remained above its biological benchmark), resulting in exploitation rates that are independent of fishery allocation. In the case of the Chilko stock, rare single-stock closures had negative impacts because they resulted in large spawner abundances that exceeded capacity and reduced abundance in subsequent years.

More commonly, however, larger mixed-stock fishery allocations resulted in  declines in return abundance and ultimately catch due to recruitment overfishing (Fig. \@ref(fig:cuTO)). These effects were particularly severe in the least abundant stock, Raft, which exhibited strong declines when mixed-stock fishery allocations exceeded 25% (Fig. \@ref(fig:cuTO)). For other stocks catches declined when mixed-stock allocations exceeded 50%.

```{r cuTO, warnings=FALSE, messages=FALSE, fig.cap="Trade-offs between stock-specific return abundance and catch across a range of mixed-stock fishery allocations. Points represent medians and whiskers represent 90th percentile intervals among Monte Carlo trials."}
cuVarsToPlot <- c("medRecRY", "medSpawners", "medCatch", "ppnYrsUpper",
                  "medTotalER")

cuDat <- buildDataCU(dirNames = dirNames, 
                     cuVars = cuVarsToPlot,
                     keyVarName = "ppnMixed", 
                     selectedCUs = summCUs) %>% 
  mutate(ppnMixed = as.factor(ppnMixed),
         mp = case_when(
           str_detect(mp, "genPA") ~ "Generic",
           str_detect(mp, "TAM") ~ "TAM"
         ),
         cuName = fct_recode(cuName, "L. Stuart" = "L.St", "Stellako" = "Stll",
                        "Quesnel" = "Qsnl", "Chilko" = "Chlk", "Harrison" = 
                          "Hrrs")) %>% 
  select(-plotOrder, -muName) %>% 
  filter(om == "ref",
         mp == "Generic")

p <- plotCUTradeoff(cuDat, consVar = "medRecRY", catchVar = "medCatch",
               facet = "cu", panel = NULL, showUncertainty = TRUE,
               xLab = "Median Catch", yLab = "Median Return Abundance",
               legendLab = "Proportion\nMixed-Stock\nTAC", lineSize = 0.75, 
               main = FALSE, axisSize = 15, dotSize = 4, hotColors = FALSE)
p[[1]]
```

```{r heatMapdata, include=FALSE}
heatMapDat <- readRDS(here::here("outputs", "generatedData", "heatMapDat.rds"))
prodDat <- heatMapDat %>% 
  dplyr::filter(scenario == "Prod")

plotHeat <- function(plotVar = "medRecRY", legName = "rec", bins = 30,
                     dat = agDat) {
  dum <- dat %>%
    filter(var == plotVar) %>% 
    mutate(xAxis = case_when(
      scenario == "Synch" ~ synch,
      scenario == "Prod" ~ prod,
    ))
  dumInterp <- akima::interp(x = dum$xAxis, y = dum$ppnMixedNew, 
                             z = dum$avg, nx = bins, ny = bins) %>% 
    akima::interp2xyz() %>% 
    as.data.frame()
  names(dumInterp) <- c("opMod", "ppnMixedNew", "value")
  ggplot(dumInterp, aes(x = opMod, y = ppnMixedNew)) + 
    geom_tile(aes(fill = value)) + 
    geom_contour(aes(z = value), color = "black", linetype = 1, size = 1.1) +
    scale_fill_gradient(name = legName, low = "#0D0D0D", high = "#E6E6E6") +
    # viridis::scale_fill_viridis(name = "legName", option = "plasma") +
    theme_sleekX(legendSize = 1.1, axisSize = 14) +
    theme(axis.title.x = element_blank(),
          axis.title.y = element_blank())
}
```

Increases or decreases in population productivity changed the effect of fishery allocations on conservation- and catch-based metrics. At high levels of productivity, increasing single-stock fishery allocations resulted in relatively large increases in the proportion of stocks above the conservation threshold; however as productivity declined the relative difference between predominantly mixed- and single-stock fishery decreased (Fig. \@ref(fig:prodTO) left). Conversely, median catch was maximized at intermediate allocations (~75% mixed stock) when productivity was high, but as productivity declined predominantly single-stock fisheries began to provide greater catches (Fig. \@ref(fig:prodTO) right). 

```{r prodTO, warnings=FALSE, messages=FALSE, fig.cap="Impacts of changes in productivity on median proportion of stocks above their conservation benchmark, $S_{con}$ (left) and median aggregate catch (right) across across a range of mixed-stock fishery allocations. Productivity is moderated by a scalar applied uniformly to the most recent estimate for each stock so that the data shown with productivity scalar = 1 is equivalent to Fig 2b."}
dumLab <- expression(atop('Ppn. Stocks', 'Above S'[con]))
ppnProd <- plotHeat(plotVar = "ppnCULower", 
                    legName = dumLab,
                    dat = prodDat)
catchProd <- plotHeat(plotVar = "medCatch", legName = "Catch",
                    dat = prodDat)

panelHeat <- ggarrange(ppnProd, catchProd,  ncol = 2, nrow = 1, 
                       widths = c(1.15, 1))
annotate_figure(panelHeat, bottom = text_grob("Productivity Scalar", size = 15,
                                              vjust = -0.5),
                left = text_grob("Proportion Mixed-Stock TAC", size = 15, 
                                 rot = 90))
```

Trade-offs between mixed- and single-stock fisheries were sensitive to the structure of the harvest control rule. A more precautionary mixed-stock harvest control rule, which replicated the framework currently used by Fraser River sockeye salmon managers, still resulted in relative larger catches in mixed-stock fisheries, but did not exhibit evidence of recruitment overfishing (i.e. no backward bending curve) (Appendix S2). Additionally, declines in conservation-based performance metrics with predominantly mixed-stock fisheries were more modest than those observed with the reference, generic mixed-stock harvest control rule (Appendix S2).

The timing of en route mortality also altered the trade-offs associated with fishery allocations. When en route mortality occurred before single-stock fisheries, median aggregate return abundance in predominantly single-stock fisheries declined relative to the reference operating model (Fig. \@ref(fig:erTO)). Additionally median aggregate catch in single-stock fisheries was considerably lower (Fig. \@ref(fig:erTO)). When en route mortality occurred before the fishery, average returns were maximized when fisheries were split evenly between mixed- and single-stock harvest, rather than being maximized under fully single-stock fisheries when en route mortality occurred after single-stock harvest.

```{r erTO, warnings=FALSE, messages=FALSE, fig.cap="The impact of en route mortality timing, relative to single-stock fisheries, on trade-offs between aggregate return abundance and catch. Points represent medians and whiskers represent 90th percentile intervals among Monte Carlo trials. Note that panel (a) is the same as Fig. 1a and is presented here to facilitate comparison."}
enRouteDat <- agDat %>% 
  filter(mp == "Generic") %>% 
  mutate(om = case_when(
    str_detect(om, "enRoute") ~ "En Route Mortality\nBefore Fishery",
    str_detect(om, "ref") ~ "En Route Mortality\nAfter Fishery"
  ))
conLabels2 <- c("Median Aggregate\nReturn Abundance", 
               "Proportion of CUs\nAbove Benchmark")
omVec <- unique(enRouteDat$om)
panelLabs <- data.frame(lab = c("a)", "b)"),
                        om = factor(omVec, levels = omVec))
labY <- enRouteDat %>% 
  filter(var == "medRecRY") %>% 
  select(lowQ) %>% 
  min()
labX <- enRouteDat %>% 
  filter(var == "medCatch") %>% 
  select(lowQ) %>% 
  min()

plotAgTradeoff(enRouteDat %>% select(-labelledVar), consVar = "medRecRY", 
               catchVar = "medCatch", facet = "om", 
               shape = NULL, showUncertainty = TRUE, 
               xLab = "Median Aggregate Catch", 
               yLab = "Median Aggregate Return", 
               legendLab = "Proportion\nMixed-Stock\nTAC",
               axisSize = 15, dotSize = 6, legendSize = 13, lineSize = 1,
               scaleAxis = "fixed", hotColors = FALSE, facetLetter = TRUE)
```

<!--chapter:end:03-results.Rmd-->

# Discussion

Shifting harvest from mixed- to single-stock fisheries may provide a means of maximizing harvest opportunities on abundant populations while minimizing risks on sympatric stocks of concern. While increasing stock selectivity has intuitive conservation benefits for Pacific salmon fisheries [@Walters2008; @Taylor2009], to our knowledge, the trade-offs among harvest and conservation objectives of such a transition has not been previously quantified. Using a stochastic, closed-loop simulation model to explore these trade-offs, we found that increasing allocations to single-stock fisheries resulted in improved conservation performance, albeit at the cost of reduced catches. We also determined that trade-offs between objectives are sensitive to the ecological scale of performance metrics, the structure of each fishery's harvest control rule, and the population dynamics within the stock aggregate.

At the aggregate scale, fully single-stock fisheries maximized return abundance and the proportion of stocks above conservation benchmarks, while fully mixed-stock fisheries resulted in reduced conservation performance, as well as reductions in long-term catches and catch stability due to recruitment overfishing. Intermediate allocations that split total allowable catch between mixed- and single-stock fisheries approximately equally typically maximized catch metrics without substantial declines in conservation performance. These results were driven by multiple factors. First, single-stock fisheries were more conservative than mixed-stock, resulting in a negative relationship between single-stock allocations and total exploitation rate. Second, even though the mixed-stock harvest control rule aimed to maintain aggregate exploitation rates at or below the level associated with maximum sustainable yield, it failed to account for differences among stocks in productivity, which reduce sustainable exploitation rates [@Ricker1973]. Third, the mixed-stock harvest control rule's reference points assumed that aggregate population dynamics were stationary and did not account for recent widespread, but non-uniform, declines in sockeye salmon productivity [@Peterman2012; @Freshwater2018]. Single-stock fisheries were more responsive to annual (generational) changes in stock-specific abundance, such that exploitation declined when spanwer abundances dropped below conservation benchmarks.

The impacts of single-stock fisheries were not homogeneous within the aggregate, but varied among populations due to differences in intrinsic productivity and carrying capacity. While the conservation performance of smaller, less productive stocks improved as single-stock allocations increased, more productive or abundant stocks exhibited mixed responses. For example, the Harrison stock's abundance regularly exceeded the conservation benchmark necessary to allow single-stock harvest to occur. Hence realized exploitation rates, as well as catch and conservation performance, were largely independent of fishery allocation. Conversely, the Chilko stock was negatively impacted by increasing single-stock fishery allocations because intermittent closures resulted in years when escapement exceeded capacity, triggering declines in abundance and catch (although escapements exceeding capacity may provide important ecosystem services such as nutrient subsidies to terrestrial systems [@Helfield2001]). Differences in yield among stocks may be driven by variation in productivity and the magnitude of density dependent effects, as in our model, or vulnerability to a mixed-stock fishery [@Walters2008]. Regardless of mechanism, different responses among populations suggest stock-specific trade-offs should be considered when evaluating changes in allocation.

A wide range of single-stock fishery frameworks could be implemented, including those that attempt to maximize aggregate catch through supplemental harvest in terminal areas [@DFO2017a], effectively attempting to fish each stock at close to its maximum sustainable yield. Yet such strategies are relatively "data-hungry", requiring assessments for individual stocks that are often lacking [@Price2008; @Holt2015], and may only produce marginal gains in long-term yield [@Walters2008]. Instead our goal was to implement a relatively simple and conservative single-stock harvest control rule that could increase the probability of maintaining stock diversity with small additional requirements in management capacity. Under the simulated harvest control rule, the decision to open a particular stock's fishery could be made before the fishing season begins based on recent abundance relative to stock recruit benchmarks (or relative to the time series average if those are lacking). This strategy attempts to address the primary goal of maintaining stock diversity [@DFO2005], without being overly constrained by data limitations.

Improvements in conservation performance as single-stock allocations increase will be sensitive to the underlying harvest control rules within each fishery. For example, mixed-stock Fraser River sockeye salmon fisheries are currently managed with a total allowable mortality rule - a framework that includes a range of precautionary adjustments, as well as a maximum exploitation rate (60%) that is below estimates of $u_{msy}$ for most stocks [@Pestal2011]. When we simulated an equivalent harvest control rule, mixed-stock fisheries had no evidence of recruitment overfishing and moderate declines in conservation performance relative to single-stock fishery management procedures. Thus there may be minimal benefits associated with developing single-stock fisheries if mixed-stock fisheries include sufficiently precautionary reference points. Such reference points, however, depend on relatively precise estimates of stock-recruit parameters and highly collaborative multi-year modeling efforts [@Pestal2011]. When these resources are unavailable, as is common for many stock aggregates, reference points for precautionary harvest control rules could be derived based on indices of abundance relative to historical averages [@Price2008; @Holt2015] or habitat-based estimates of capacity [@Parken2006], but these have not yet been widely applied.

The performance of single-stock fisheries will be sensitive to ecological processes outside of fisheries managers' control. For example, when productivity declines are widespread, abundance-based mixed-stock harvest control rules still result in low exploitation rates and single-stock fisheries provided minimal additional improvements. As a result, a transition to single-stock fisheries is unlikely to counteract declines in salmon abundance driven by widespread, synchronous declines in marine survival [@Peterman2012; @Dorner2017]. In fact, increasing covariance among stocks, as observed in Fraser River sockeye salmon, may result in modest improvements in the performance of mixed-stock harvest control rules as stock aggregates increasingly behave like single populations [@FreshwaterSub].

Options to increase stock selectivity are limited when a salmon aggregate contains populations that share similar migration phenologies [@Walters2008]. In such a situation developing single-stock fisheries likely requires moving harvest to terminal areas and several additional management considerations. First adult fish will recruit into the fishery only after completing their freshwater migrations. En route mortality rates can exceed 90% in certain years [@Cooke2004] and high mortality events are likely to increase due to climate change impacts [@Martins2011]. Thus terminal single-stock fisheries will have access to less harvestable biomass than downstream marine fisheries, resulting in reduced catches. Furthermore, management uncertainty in terminal fisheries may increase if precise estimates of spawner abundance are not available in-season for all stocks, increasing the consequences of overharvest if stocks are at low abundance due to en route mortality.

The decision to change allocations between mixed- and single-stock fisheries will ultimately need to incorporate a broad range of socio-economic factors. For example, the landed value per weight terminal catches will be lower than marine caught fish because salmon expend large portions of their energy reserves while migrating [@Taylor2009]. Perhaps more importantly, increasing single-stock harvest will result in changes in access among user groups. Ideally a full management strategy evaluation could be used to specify conservation and socio-economic objectives of all stakeholders, then quantify trade-offs prior to changes in allocation [@Punt2016]. Nevertheless, these simulations demonstrate that intermediate strategies that incorporate both mixed- and single-stock fisheries may improve conservation performance while minimizing reductions in catch. 

## Supporting Information

Detailed methods (Appendix S1), supplementary figures (Appendix S2), and sensitivity analyses (Appendix S3) are available online. The authors are solely responsible for the content and functionality of these materials. Queries (other than absence of the material) should be directed to the corresponding author.

<!--chapter:end:04-discussion.Rmd-->

<!--
The bib chunk below must go last in this document according to how R Markdown renders.  More info is at http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html

In general, you shouldn't need to edit this file.
-->

\clearpage

# REFERENCES {-}
<!--This manually sets the header for this unnumbered chapter.-->
\markboth{References}{References}

\noindent
\vspace{-2em}
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}

<!--chapter:end:99-references.Rmd-->

