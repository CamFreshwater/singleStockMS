# singleStockMS
## Analyses to explore consequences of changing fishery allocations using closed-loop simulations

-----

*Authors: C. Freshwater*

*Date: September 17, 2019

*Contact: cameron.freshwater@dfo-mpo.gc.ca*

-----

### Summary
The `singleStockMS` repository contains the data and models necessary to complete the analysis within *Benefits and limitations of increasing the stock-selectivity of Pacific salmon fisheries (submitted)*. The goal of this study was to evaluate how trade-offs between catch- and conservation-based objectives were influenced by increasing stock-selectivity (by shifting TAC to single-stock fisheries). To answer these questions we used a closed-loop simulation model that was originally developed to address generic questions related to rebuilding Pacific salmon stock aggregates. This model is contained within a separate package `samSim`. 

*To install samSim*
```
install.packages("devtools")
devtools::install_github("CamFreshwater/samSim")
```

The manuscript was written using the `csasdown` package in R Markdown, an extension of the `bookdown` package. As a result a large number of directories contain information necessary to "knit" the document, but are not directly relevant to the analysis, and some naming conventions and formatting will appear unusual. 

A summary of the relevant files is provided below. Most functions are provided in `samSim` and contain relatively detailed documentation (and sometimes functioning examples). Details on how to run a simulation are provided in exampleSimRun.Rmd in the `samSim` package's repository under Rmd directory. Details on the operating model (biological dynamics and fishery interactions) and the management procedures (harvest control rule and assessment process) will be provided in the `samSim` vignette at a future date.

Zenodo: [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.2594082.svg)](https://doi.org/10.5281/zenodo.2594082)

-----

### Files
The repository contains the following directories:

#### data
- Contains .csv files used as inputs to parameterize the operating model of the `recoverySim()` function
Also includes subdirectories:
  - `manProcScenarios` - Includes management procedure input files for main analysis, the variable productivity analysis, and the sensitivity analysis
  - `msTables` - Input data to populate tables in manuscript

#### knitr-figs-docx
Contains figures (main text and supplementary) .

#### outputs
Includes subdirectories:
- *diagnostics* - Automatically generated by `recoverySim()` and used to store diagnostic plots representing the outputs from single trials.
- *generatedData* - Used to store data files generated in post-analysis scripts.
- *simData* - Automatically generated by `recoverySim()` and contains output from simulation runs. Each directory within simData represents a series of related scenarios, in this case each represents a given component variability and productivity operating model with multiple synchrony operating models nested inside.

#### scripts
Contains R scripts necessary to conduct forward simulation analyses. Focal scripts are listed below, remainder are helper functions necessary to estimate stock recruit parameters or prep raw data.
- *varyAllocation_mainSimRun* - Runs forward simulation for main analysis in main text.
- *varyAllocation_fullProdRange* - Runs forward simulation across wide range of productivity scenarios (used to generate heat map in main text).
- *varyAllocation_singleStock_Sens* - Runs forward simulation for sensitivity analyses.